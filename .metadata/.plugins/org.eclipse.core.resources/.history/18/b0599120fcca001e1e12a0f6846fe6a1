
package edu.sru.group7.roomallocation.controller;

import java.io.IOException;
import java.util.Base64;
import java.util.Optional;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.util.StringUtils;
import org.springframework.validation.BindingResult;
import org.springframework.validation.annotation.Validated;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.multipart.MultipartFile;

import edu.sru.group7.roomallocation.domain.*;

import edu.sru.group7.roomallocation.repositories.*;

@Controller
public class DropdownOptionController {
	
	@Autowired
    private SpaceUseCodeRepository spaceUseCodeRepository;
	
	@Autowired
    private SpaceConditionRepository spaceConditionRepository;
	
	@Autowired
	private FurnitureRepository furnitureRepository;
	
	@Autowired
	private StructuralFeaturesRepository structuralFeaturesRepository;

    
	public DropdownOptionController() {
	}

    public DropdownOptionController(SpaceUseCodeRepository spaceUseCodeRepository,
                                    SpaceConditionRepository spaceConditionRepository,
                                    FurnitureRepository furnitureRepository,
                                    StructuralFeaturesRepository structuralFeaturesRepository
                                    ) {
        
        this.spaceUseCodeRepository = spaceUseCodeRepository;
        this.spaceConditionRepository = spaceConditionRepository;
        this.furnitureRepository = furnitureRepository;
        this.structuralFeaturesRepository = structuralFeaturesRepository;
        
    }
    
    
    //Mapping for the /admin URL when initiated through Tomcat
    //lists all the dropdown options for admin to manage
    @RequestMapping({ "/list" })
    public String showDropdownList (Model model) {
        model.addAttribute("spaceUseCodeOptions", spaceUseCodeRepository.findAll());
        model.addAttribute("spaceConditionOptions", spaceConditionRepository.findAll());
		model.addAttribute("furnitureOptions", furnitureRepository.findAll()); 
		model.addAttribute("structuralFeaturesOptions", structuralFeaturesRepository.findAll());
        
        model.addAttribute("addEndpointSpaceUseCode", "/spaceUseCode/add");
        model.addAttribute("newDropdownOptionSpaceUseCode", new SpaceUseCode());
        
        model.addAttribute("addEndpointSpaceCondition", "/spaceCondition/add");
        model.addAttribute("newDropdownOptionSpaceCondition", new SpaceCondition());
        
        model.addAttribute("addEndpointFurniture", "/furniture/add");
        model.addAttribute("newDropdownOptionFurniture", new Furniture());
        
        model.addAttribute("addEndpointStructuralFeatures", "/structuralFeatures/add");
        model.addAttribute("newDropdownOptionStructuralFeatures", new StructuralFeatures());
        
    	return "list";
    }
    
  //Crud operations for SpaceUseCode
    @GetMapping("/spaceUseCode/add")
    public String addSpaceUseCodeForm(Model model) {
        model.addAttribute("addEndpointSpaceUseCode", "/spaceUseCode/add");
        model.addAttribute("newDropdownOptionSpaceUseCode", new SpaceUseCode());
        return "list"; //"add-option"; 
    }

    @PostMapping("/spaceUseCode/add")
    public String addSpaceUseCode(@ModelAttribute("spaceUseCode") SpaceUseCode spaceUseCode) {
        spaceUseCodeRepository.save(spaceUseCode);
        return "redirect:/list";
    }

    @GetMapping("/spaceUseCode/delete/{id}")
    public String deleteSpaceUseCode(@PathVariable Integer id) {
        spaceUseCodeRepository.deleteById(id);
        return "redirect:/list";
    }
    
    //Crud operations for SpaceCondition
    @GetMapping("/spaceCondition/add")
    public String addSpaceConditionForm(Model model) {
        model.addAttribute("addEndpointSpaceCondition", "/spaceCondition/add");
        model.addAttribute("newDropdownOptionSpaceCondition", new SpaceCondition());
        return "list";//"add-option";
    }

    @PostMapping("/spaceCondition/add")
    public String addSpaceCondition(@ModelAttribute("spaceCondition") SpaceCondition spaceCondition) {
        spaceConditionRepository.save(spaceCondition);
        return "redirect:/list";
    }

    @GetMapping("/spaceCondition/delete/{id}")
    public String deleteSpaceCondition(@PathVariable Integer id) {
        spaceConditionRepository.deleteById(id);
        return "redirect:/list";
    }
    
    
    //Crud operations for Furniture
    @GetMapping("/furniture/add")
    public String addFurnitureForm(Model model) {
        model.addAttribute("addEndpointFurniture", "/furniture/add");
        model.addAttribute("newDropdownOptionFurniture", new Furniture());
        return "list"; //"add-option"; 
    }

    @PostMapping("/furniture/add")
    public String addFurnitureCode(@ModelAttribute("furniture") Furniture furniture) {
        furnitureRepository.save(furniture);
        return "redirect:/list";
    }

    @GetMapping("/furniture/delete/{id}")
    public String deleteFurniture(@PathVariable Integer id) {
        furnitureRepository.deleteById(id);
        return "redirect:/list";
    }
    
    
    //Crud operations for StructuralFeatures
    @GetMapping("/structuralFeatures/add")
    public String addStructuralFeaturesForm(Model model) {
        model.addAttribute("addEndpointStructuralFeatures", "/structuralFeatures/add");
        model.addAttribute("newDropdownOptionStructuralFeatures", new StructuralFeatures());
        return "list"; //"add-option"; 
    }

    @PostMapping("/structuralFeatures/add")
    public String addStructuralFeatures(@ModelAttribute("structuralFeatures") StructuralFeatures structuralFeatures) {
    	structuralFeaturesRepository.save(structuralFeatures);
        return "redirect:/list";
    }

    @GetMapping("/structuralFeatures/delete/{id}")
    public String deleteStructuralFeatures(@PathVariable Integer id) {
    	structuralFeaturesRepository.deleteById(id);
        return "redirect:/list";
    }
}
